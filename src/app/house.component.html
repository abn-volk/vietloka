<!-- Component for houses page -->

<div class="container mt-3" *ngIf="!!house">


  <ngb-carousel *ngIf="house.image.length > 0 && house.image[0] != ''" style="background: black">
    <ng-template ngbSlide *ngFor="let slide of house.image">
      <img [src]="trustResource(slide)" height="500px" class="mx-auto">
    </ng-template>
  </ngb-carousel>

  <div class="mt-3"></div>

  <div class="hidden-md-up" *ngIf="!(isLoggedIn && isHost && !isGuest)">

    <!-- Check if users logged in to use rent feature -->
    <div class="row">
      <button type="button" class="btn btn-success btn-lg mx-auto"
        [disabled]="!isLoggedIn || !isGuest"
        (click)="doStay()">Stay at this place</button>
    </div>
    <p *ngIf="!isLoggedIn" class="form-text text-muted">
      Please <a routerLink="/login">log into Vietloka</a> or <a routerLink="/register">register an account</a> to use this feature.
    </p>
    <p *ngIf="isLoggedIn && !isGuest" class="form-text text-muted">
      Your account is not verified. <a routerLink="/verify">Verify</a> your account to become a guest.
    </p>
    <br>
  </div>

  <div class="row">
    <div class="col-md-6">
      <h2>{{house.title}}</h2>
      <p class="lead">{{house.address}}</p>
      <p>{{house.description}}</p>

      <hr>

      <h3>About this place</h3>
      <ul class="list-unstyled">
        <li>Price: {{house.price}} VND per day</li>
        <li>Area: {{house.area}} sqm</li>
        <li>Number of guests: {{house.numOfTotalSlots}}</li>
        <li>Children: <span *ngIf="house.hasChildren">Yes</span><span *ngIf="!house.hasChildren">No</span></li>
        <li>Elderly people: <span *ngIf="house.hasOlders">Yes</span><span *ngIf="!house.hasOlders">No</span></li>
      </ul>

      <hr>

      <h4>Conveniences</h4>
      <ul class="list-unstyled">
        <li><span *ngIf="house.hasElectricHeater" class="text-success"><b>✓</b> water heater</span>
            <span *ngIf="!house.hasElectricHeater" class="text-danger"><b>✗</b>  water heater</span>
        </li>
        <li><span *ngIf="house.hasWashingMachine" class="text-success"><b>✓</b> washing machine</span>
            <span *ngIf="!house.hasWashingMachine" class="text-danger"><b>✗</b> washing machine</span>
        </li>
        <li><span *ngIf="house.hasTV" class="text-success"><b>✓</b> television</span>
            <span *ngIf="!house.hasTV" class="text-danger"><b>✗</b> television</span>
        </li>
        <li><span *ngIf="house.hasInternet" class="text-success"><b>✓</b> internet</span>
            <span *ngIf="!house.hasInternet" class="text-danger"><b>✗</b> internet</span>
        </li>
        <li><span *ngIf="house.hasCarPark" class="text-success"><b>✓</b> car park</span>
            <span *ngIf="!house.hasCarPark" class="text-danger"><b>✗</b> car park</span>
        </li>
        <li><span *ngIf="house.WC != 'None'" class="text-success"><b>✓</b> toilet <span *ngIf="house.WC=='Squat'">(squat)</span><span *ngIf="house.WC=='Western'">(Western)</span></span>
            <span *ngIf="house.WC == 'None'" class="text-danger"><b>✗</b> toilet</span>
        </li>
      </ul>
    </div>

    <div class="col-md-6">
      <div class="hidden-sm-down" *ngIf="!(isLoggedIn && isHost && !isGuest)">
        <div class="row">
          <button type="button" class="btn btn-success btn-lg mx-auto"
            [disabled]="!isLoggedIn || !isGuest"
            (click)="doStay()">Stay at this place</button>
        </div>
        <p *ngIf="!isLoggedIn" class="form-text text-muted">
          Please <a routerLink="/login">log into Vietloka</a> or <a routerLink="/register">register an account</a> to use this feature.
        </p>
        <p *ngIf="isLoggedIn && !isGuest" class="form-text text-muted">
          Your account is not verified. <a routerLink="/verify">Verify</a> your account to become a guest.
        </p>
      </div>
      <hr>
      <div>
        <h4 class="text-center">About the host</h4>
        <p class="text-center"><img *ngIf="house.owner.picture" [src]="house.owner.picture" class="img-thumbnail rounded-circle"></p>
        <p class="lead text-center">
          <a routerLink="/host/{{house.owner.id}}">{{house.owner.name}}</a>
        </p>
        <p class="text-center"><a href="mailto:{{house.owner.email}}">✉ {{house.owner.email}}</a></p>
      </div>
    </div>
  </div>

  <hr>
  <h4>Reviews (<span class="text-success">{{ratings.approval}}</span>/<span class="text-danger">{{ratings.disapproval}}</span>)</h4>
  <div>
    <div class="card" *ngFor="let comment of comments; let i = index" [attr.data-index]="i">
      <div class="card-block">
        <div class="row" >
          <div><img *ngIf="users[i].picture" [src]="users[i].picture" class="img-thumbnail rounded-circle"></div>
          <div class="col">
            <ul class="list-unstyled">
            <li><h4>{{users[i].name}}</h4></li>
            <li class="lead text-success" [ngClass]="{'text-danger': !comments[i].approves}">{{comments[i].title}}</li>
            <li>{{comments[i].content}}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    
  </div>


  <ng-template #rentModal>
  <div class="modal-header">
      <h4 class="modal-title">Success!</h4>
    </div>
    <div class="modal-body">
      <p>Your host will be notified shortly.</p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modalRef.close()">OK</button>
    </div>
  </ng-template>
</div>`
